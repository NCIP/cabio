/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

//>>built
define("dojo/robotx",["dojo","dojo/sniff","dojo/robot"],function(_1,_2){_1.experimental("dojo.robotx");var _3=null;var _4;var _5=_1.connect(doh,"_groupStarted",function(){_1.disconnect(_5);_3.style.visibility="visible";});var _6=function(_7){_1.ready(function(){var _8={overflow:_2("webkit")?"hidden":"visible",margin:"0px",borderWidth:"0px",height:"100%",width:"100%"};_1.style(document.documentElement,_8);_1.style(document.body,_8);_3=document.createElement("iframe");_3.src=_7;_3.setAttribute("ALLOWTRANSPARENCY","true");_3.scrolling=_2("ie")?"yes":"auto";var _9=(document.compatMode=="BackCompat")?document.body:document.documentElement;var _a=document.getElementById("robotconsole").offsetHeight;_1.style(_3,{visibility:"hidden",border:"0px none",padding:"0px",margin:"0px",position:"absolute",left:"0px",top:"0px",width:"100%",height:_a?(_9.clientHeight-_a)+"px":"100%"});if(_3["attachEvent"]!==undefined){_3.attachEvent("onload",_b);}else{_1.connect(_3,"onload",_b);}document.body.appendChild(_3);var _c=document.createElement("base");_c.href=_3.src;document.getElementsByTagName("head")[0].appendChild(_c);});};var _d=false;var _e=null;var _f=doh.robot._run;doh.robot._run=function(_10){_d=true;_e=_10;doh.robot._run=_f;if(_4){_6(_4);}};var _11=function(){doh.robot._updateDocument();_11=null;if(_3.contentWindow.dojo){_3.contentWindow.dojo.ready(999,function(){doh.robot._run(_e);});}else{doh.robot._run(_e);}};var _b=function(){if(_11){_11();}var _12=_1.connect(_1.body(),"onunload",function(){_1.global=window;_1.doc=document;_1.disconnect(_12);});};_1.config.debugContainerId="robotconsole";_1.config.debugHeight=_1.config.debugHeight||200;document.write("<div id=\"robotconsole\" style=\"position:absolute;left:0px;bottom:0px;width:100%;\"></div>");_1.mixin(doh.robot,{_updateDocument:function(){_1.setContext(_3.contentWindow,_3.contentWindow.document);var win=_1.global;if(win.dojo){_1.publish=win.dojo.publish;_1.subscribe=win.dojo.subscribe;_1.connectPublisher=win.dojo.connectPublisher;}},initRobot:function(url){if(_d){_6(url);}else{_4=url;}},waitForPageToLoad:function(_13){var d=new doh.Deferred();_11=function(){_11=null;doh.robot._updateDocument();d.callback(true);};_13();return d;}});return doh.robot;});