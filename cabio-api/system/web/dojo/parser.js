/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

//>>built
define("dojo/parser",["./_base/kernel","./_base/lang","./_base/array","./_base/config","./_base/html","./_base/window","./_base/url","./_base/json","./aspect","./date/stamp","./query","./on","./ready"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d){new Date("X");var _e={"dom-attributes-explicit":document.createElement("div").attributes.length<40};function _f(_10){return _e[_10];};_1.parser=new function(){var _11={};function _12(_13){var map={};for(var _14 in _13){if(_14.charAt(0)=="_"){continue;}map[_14.toLowerCase()]=_14;}return map;};_9.after(_2,"extend",function(){_11={};},true);var _15={};this._functionFromScript=function(_16,_17){var _18="";var _19="";var _1a=(_16.getAttribute(_17+"args")||_16.getAttribute("args"));if(_1a){_3.forEach(_1a.split(/\s*,\s*/),function(_1b,idx){_18+="var "+_1b+" = arguments["+idx+"]; ";});}var _1c=_16.getAttribute("with");if(_1c&&_1c.length){_3.forEach(_1c.split(/\s*,\s*/),function(_1d){_18+="with("+_1d+"){";_19+="}";});}return new Function(_18+_16.innerHTML+_19);};this.instantiate=function(_1e,_1f,_20){var _21=[],_1f=_1f||{};_20=_20||{};var _22=(_20.scope||_1._scopeName)+"Type",_23="data-"+(_20.scope||_1._scopeName)+"-",_24=_23+"type",_25=_23+"props",_26=_23+"attach-point",_27=_23+"attach-event",_28=_23+"id";var _29={};_3.forEach([_25,_24,_22,_28,"jsId",_26,_27,"dojoAttachPoint","dojoAttachEvent","class","style"],function(_2a){_29[_2a.toLowerCase()]=_2a.replace(_20.scope,"dojo");});_3.forEach(_1e,function(obj){if(!obj){return;}var _2b=obj.node||obj,_2c=_22 in _1f?_1f[_22]:obj.node?obj.type:(_2b.getAttribute(_24)||_2b.getAttribute(_22)),_2d=_15[_2c]||(_15[_2c]=(_2.getObject(_2c)||require(_2c))),_2e=_2d&&_2d.prototype;var _2f={};if(_20.defaults){_2.mixin(_2f,_20.defaults);}if(obj.inherited){_2.mixin(_2f,obj.inherited);}var _30;if(_f("dom-attributes-explicit")){_30=_2b.attributes;}else{var _31=/^input$|^img$/i.test(_2b.nodeName)?_2b:_2b.cloneNode(false),_32=_31.outerHTML.replace(/=[^\s"']+|="[^"]*"|='[^']*'/g,"").replace(/^\s*<[a-zA-Z0-9]*\s*/,"").replace(/\s*>.*$/,"");_30=_3.map(_32.split(/\s+/),function(_33){var _34=_33.toLowerCase();return {name:_33,value:(_2b.nodeName=="LI"&&_33=="value")||_34=="enctype"?_2b.getAttribute(_34):_2b.getAttributeNode(_34).value,specified:true};});}var i=0,_35;while(_35=_30[i++]){if(!_35||!_35.specified){continue;}var _36=_35.name,_37=_36.toLowerCase(),_38=_35.value;if(_37 in _29){switch(_29[_37]){case "data-dojo-props":var _39=_38;break;case "data-dojo-id":case "jsId":var _3a=_38;break;case "data-dojo-attach-point":case "dojoAttachPoint":_2f.dojoAttachPoint=_38;break;case "data-dojo-attach-event":case "dojoAttachEvent":_2f.dojoAttachEvent=_38;break;case "class":_2f["class"]=_2b.className;break;case "style":_2f["style"]=_2b.style&&_2b.style.cssText;break;}}else{if(!(_36 in _2e)){var map=(_11[_2c]||(_11[_2c]=_12(_2e)));_36=map[_37]||_36;}if(_36 in _2e){switch(typeof _2e[_36]){case "string":_2f[_36]=_38;break;case "number":_2f[_36]=_38.length?Number(_38):NaN;break;case "boolean":_2f[_36]=_38.toLowerCase()!="false";break;case "function":if(_38===""||_38.search(/[^\w\.]+/i)!=-1){_2f[_36]=new Function(_38);}else{_2f[_36]=_2.getObject(_38,false)||new Function(_38);}break;default:var _3b=_2e[_36];_2f[_36]=(_3b&&"length" in _3b)?(_38?_38.split(/\s*,\s*/):[]):(_3b instanceof Date)?(_38==""?new Date(""):_38=="now"?new Date():_a.fromISOString(_38)):(_3b instanceof _1._Url)?(_1.baseUrl+_38):_8.fromJson(_38);}}else{_2f[_36]=_38;}}}if(_39){try{_39=_8.fromJson.call(_20.propsThis,"{"+_39+"}");_2.mixin(_2f,_39);}catch(e){throw new Error(e.toString()+" in data-dojo-props='"+_39+"'");}}_2.mixin(_2f,_1f);var _3c=obj.node?obj.scripts:(_2d&&(_2d._noScript||_2e._noScript)?[]:_b("> script[type^='dojo/']",_2b));var _3d=[],_3e=[],_3f=[],on=[];if(_3c){for(i=0;i<_3c.length;i++){var _40=_3c[i];_2b.removeChild(_40);var _41=(_40.getAttribute(_23+"event")||_40.getAttribute("event")),_42=_40.getAttribute(_23+"prop"),_2c=_40.getAttribute("type"),nf=this._functionFromScript(_40,_23);if(_41){if(_2c=="dojo/connect"){_3d.push({event:_41,func:nf});}else{if(_2c=="dojo/on"){on.push({event:_41,func:nf});}else{_2f[_41]=nf;}}}else{if(_2c=="dojo/watch"){_3f.push({prop:_42,func:nf});}else{_3e.push(nf);}}}}var _43=_2d.markupFactory||_2e.markupFactory;var _44=_43?_43(_2f,_2b,_2d):new _2d(_2f,_2b);_21.push(_44);if(_3a){_2.setObject(_3a,_44);}for(i=0;i<_3d.length;i++){_9.after(_44,_3d[i].event,_1.hitch(_44,_3d[i].func),true);}for(i=0;i<_3e.length;i++){_3e[i].call(_44);}for(i=0;i<_3f.length;i++){_44.watch(_3f[i].prop,_3f[i].func);}for(i=0;i<on.length;i++){_c(_44,on[i].event,on[i].func);}},this);if(!_1f._started){_3.forEach(_21,function(_45){if(!_20.noStart&&_45&&_2.isFunction(_45.startup)&&!_45._started){_45.startup();}});}return _21;};this.parse=function(_46,_47){var _48;if(!_47&&_46&&_46.rootNode){_47=_46;_48=_47.rootNode;}else{_48=_46;}_48=_48?_5.byId(_48):_6.body();_47=_47||{};var _49=(_47.scope||_1._scopeName)+"Type",_4a="data-"+(_47.scope||_1._scopeName)+"-",_4b=_4a+"type",_4c=_4a+"textdir";var _4d=[];var _4e=_48.firstChild;var _4f=_47&&_47.inherited;if(!_4f){function _50(_51,_52){return (_51.getAttribute&&_51.getAttribute(_52))||(_51!==_6.doc&&_51!==_6.doc.documentElement&&_51.parentNode?_50(_51.parentNode,_52):null);};_4f={dir:_50(_48,"dir"),lang:_50(_48,"lang"),textDir:_50(_48,_4c)};for(var key in _4f){if(!_4f[key]){delete _4f[key];}}}var _53={inherited:_4f};var _54;var _55;function _56(_57){if(!_57.inherited){_57.inherited={};var _58=_57.node,_59=_56(_57.parent);var _5a={dir:_58.getAttribute("dir")||_59.dir,lang:_58.getAttribute("lang")||_59.lang,textDir:_58.getAttribute(_4c)||_59.textDir};for(var key in _5a){if(_5a[key]){_57.inherited[key]=_5a[key];}}}return _57.inherited;};while(true){if(!_4e){if(!_53||!_53.node){break;}_4e=_53.node.nextSibling;_54=_53.scripts;_55=false;_53=_53.parent;continue;}if(_4e.nodeType!=1){_4e=_4e.nextSibling;continue;}if(_54&&_4e.nodeName.toLowerCase()=="script"){_5b=_4e.getAttribute("type");if(_5b&&/^dojo\/\w/i.test(_5b)){_54.push(_4e);}_4e=_4e.nextSibling;continue;}if(_55){_4e=_4e.nextSibling;continue;}var _5b=_4e.getAttribute(_4b)||_4e.getAttribute(_49);var _5c=_4e.firstChild;if(!_5b&&(!_5c||(_5c.nodeType==3&&!_5c.nextSibling))){_4e=_4e.nextSibling;continue;}var _5d={node:_4e,scripts:_54,parent:_53};var _5e;try{_5e=_5b&&(_15[_5b]||(_15[_5b]=(_2.getObject(_5b)||require(_5b))));}catch(e){}var _5f=_5e&&!_5e.prototype._noScript?[]:null;if(_5b){_4d.push({"type":_5b,node:_4e,scripts:_5f,inherited:_56(_5d)});}_4e=_5c;_54=_5f;_55=_5e&&_5e.prototype.stopParser&&!(_47&&_47.template);_53=_5d;}var _60=_47&&_47.template?{template:true}:null;return this.instantiate(_4d,_60,_47);};}();if(_4.parseOnLoad){_d(100,_1.parser,"parse");}return _1.parser;});