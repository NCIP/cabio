//>>built
define("dijit/_MenuBase",["dojo/_base/array","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-class","dojo/_base/lang","dojo/mouse","dojo/on","dojo/window","./popup","./registry","./_Widget","./_KeyNavContainer","./_OnDijitClickMixin","./_TemplatedMixin"],function(_1,_2,_3,_4,_5,_6,_7,on,_8,pm,_9,_a,_b,_c,_d){return _2("dijit._MenuBase",[_a,_d,_b],{parentMenu:null,popupDelay:500,postCreate:function(){var _e=this;this._connects.push(on(this.containerNode,on.selector(".dijitMenuItem",_7.enter),function(){_e.onItemHover(_9.byNode(this));}),on(this.containerNode,on.selector(".dijitMenuItem",_7.leave),function(){_e.onItemUnhover(_9.byNode(this));}),on(this.containerNode,on.selector(".dijitMenuItem",_c.a11yclick),function(_f){_e.onItemClick(_9.byNode(this),_f);_f.stopPropagation();_f.preventDefault();}));this.inherited(arguments);},onExecute:function(){},onCancel:function(){},_moveToPopup:function(evt){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled){this.onItemClick(this.focusedChild,evt);}else{var _10=this._getTopMenu();if(_10&&_10._isMenuBar){_10.focusNext();}}},_onPopupHover:function(){if(this.currentPopup&&this.currentPopup._pendingClose_timer){var _11=this.currentPopup.parentMenu;if(_11.focusedChild){_11.focusedChild._setSelected(false);}_11.focusedChild=this.currentPopup.from_item;_11.focusedChild._setSelected(true);this._stopPendingCloseTimer(this.currentPopup);}},onItemHover:function(_12){if(this.isActive){this.focusChild(_12);if(this.focusedChild.popup&&!this.focusedChild.disabled&&!this.hover_timer){this.hover_timer=setTimeout(_6.hitch(this,"_openPopup"),this.popupDelay);}}if(this.focusedChild){this.focusChild(_12);}this._hoveredChild=_12;_12._set("hovering",true);},_onChildBlur:function(_13){this._stopPopupTimer();_13._setSelected(false);var _14=_13.popup;if(_14){this._stopPendingCloseTimer(_14);_14._pendingClose_timer=setTimeout(function(){_14._pendingClose_timer=null;if(_14.parentMenu){_14.parentMenu.currentPopup=null;}pm.close(_14);},this.popupDelay);}},onItemUnhover:function(_15){if(this.isActive){this._stopPopupTimer();}if(this._hoveredChild==_15){this._hoveredChild=null;}_15._set("hovering",false);},_stopPopupTimer:function(){if(this.hover_timer){clearTimeout(this.hover_timer);this.hover_timer=null;}},_stopPendingCloseTimer:function(_16){if(_16._pendingClose_timer){clearTimeout(_16._pendingClose_timer);_16._pendingClose_timer=null;}},_stopFocusTimer:function(){if(this._focus_timer){clearTimeout(this._focus_timer);this._focus_timer=null;}},_getTopMenu:function(){for(var top=this;top.parentMenu;top=top.parentMenu){}return top;},onItemClick:function(_17,evt){if(typeof this.isShowingNow=="undefined"){this._markActive();}this.focusChild(_17);if(_17.disabled){return false;}if(_17.popup){this._openPopup();}else{this.onExecute();_17._onClick?_17._onClick(evt):_17.onClick(evt);}},_openPopup:function(){this._stopPopupTimer();var _18=this.focusedChild;if(!_18){return;}var _19=_18.popup;if(_19.isShowingNow){return;}if(this.currentPopup){this._stopPendingCloseTimer(this.currentPopup);pm.close(this.currentPopup);}_19.parentMenu=this;_19.from_item=_18;var _1a=this;pm.open({parent:this,popup:_19,around:_18.domNode,orient:this._orient||["after","before"],onCancel:function(){_1a.focusChild(_18);_1a._cleanUp();_18._setSelected(true);_1a.focusedChild=_18;},onExecute:_6.hitch(this,"_cleanUp")});this.currentPopup=_19;_19.connect(_19.domNode,"onmouseenter",_6.hitch(_1a,"_onPopupHover"));if(_19.focus){_19._focus_timer=setTimeout(_6.hitch(_19,function(){this._focus_timer=null;this.focus();}),0);}},_markActive:function(){this.isActive=true;_5.replace(this.domNode,"dijitMenuActive","dijitMenuPassive");},onOpen:function(){this.isShowingNow=true;this._markActive();},_markInactive:function(){this.isActive=false;_5.replace(this.domNode,"dijitMenuPassive","dijitMenuActive");},onClose:function(){this._stopFocusTimer();this._markInactive();this.isShowingNow=false;this.parentMenu=null;},_closeChild:function(){this._stopPopupTimer();if(this.currentPopup){if(_1.indexOf(this._focusManager.activeStack,this.id)>=0){_4.set(this.focusedChild.focusNode,"tabIndex",this.tabIndex);this.focusedChild.focusNode.focus();}pm.close(this.currentPopup);this.currentPopup=null;}if(this.focusedChild){this.focusedChild._setSelected(false);this.onItemUnhover(this.focusedChild);this.focusedChild=null;}},_onItemFocus:function(_1b){if(this._hoveredChild&&this._hoveredChild!=_1b){this.onItemUnhover(this._hoveredChild);}},_onBlur:function(){this._cleanUp();this.inherited(arguments);},_cleanUp:function(){this._closeChild();if(typeof this.isShowingNow=="undefined"){this._markInactive();}}});});